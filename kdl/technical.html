<!DOCTYPE html>

<!--I'm not good at HTML, so it's possible that there's some terrible markup lurking in here!-->
<html>
	<head>
		<script src="https://code.jquery.com/jquery-3.6.0.slim.min.js" integrity="sha256-u7e5khyithlIdTpu22PHhENmPcRdFiHRjhAuHcs05RI=" crossorigin="anonymous"></script>
		<script src="https://kit.fontawesome.com/4b4fac7993.js" crossorigin="anonymous"></script>
		<link rel="stylesheet" type="text/css" href="style.css">
		<title>KDL Technical information</title>
		<meta charset="utf-8">
	</head>
	<body>
		<div id="pcsx2">
			<h2>A note about PCSX2</h2>
			<p>Me and other members who are investigating the inner workings of Kya DL use <a href="https://www.cheatengine.org/" target="_blank">Cheat engine <i class="fas fa-external-link-alt"></i></a> to find variables and save the findings in a cheat table file, because it's a very powerful and flexible program.<br>
			However, the latest betas (1.7.0-dev-*) of the <a href="https://www.pcsx2.net/" target="_blank">PCSX2 <i class="fas fa-external-link-alt"></i></a> emulator, as well as any future stable release after 1.6.0, don't always map the PS2 RAM (or at least the EE RAM) at the same location, and this is by design (older versions seem to always map the RAM starting at address 0x20000000).<br>
			But since, at least with current observations, the starting location seems to only switch between 0x20000000 and 0x30000000, it's possible to keep using Cheat Engine, and change the addresses stored in the cheat table when needed. I created a simple Python script that allows the user to drag and drop the CT file on the script, and it will create a copy of the file with the addresses changed.<br><br>
			Note: the reason I personally use the 1.7.0 betas instead of the stable version is because the betas have added support for TAS stuff, and more in particular support for frame advancing, which can be extremely helpful in some circumstances.</p>
			<p><a href="kdl_ct.py" download>Download .py script</a><br>
			<a href="kdl_ct.exe" download>Download .exe script</a></p>
		</div>
		<div id="joker">
			<h2>Joker codes</h2>
			<p>Addresses that contain the button reading from the controller. In Kya DL, they're stored at <span class="ms">0495B30, 0495B9C</span> and <span class="ms">0495C1C</span> and have these base values:</p>
			<table>
				<tr>
					<th>Button</th>
					<th>7</th>
					<th>6</th>
					<th>5</th>
					<th>4</th>
					<th>3</th>
					<th>2</th>
					<th>1</th>
					<th>0</th>
					<th>7</th>
					<th>6</th>
					<th>5</th>
					<th>4</th>
					<th>3</th>
					<th>2</th>
					<th>1</th>
					<th>0</th>
					<th>Hex value</th>
				</tr>
				<tr>
					<td><img src="./btn/s.png" alt="□"> Square</td>
					<td class="tb">0</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>7FFF</td>
				</tr>
				<tr>
					<td><img src="./btn/x.png" alt="X"> Cross</td>
					<td>1</td>
					<td class="tb">0</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>BFFF</td>
				</tr>
				<tr>
					<td><img src="./btn/o.png" alt="O"> Circle</td>
					<td>1</td>
					<td>1</td>
					<td class="tb">0</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>DFFF</td>
				</tr>
				<tr>
					<td><img src="./btn/t.png" alt="△"> Triangle</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td class="tb">0</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>EFFF</td>
				</tr>
				<tr>
					<td><img src="./btn/r1.png" alt="R1"> R1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td class="tb">0</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>F7FF</td>
				</tr>
				<tr>
					<td><img src="./btn/l1.png" alt="L1"> L1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td class="tb">0</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>FBFF</td>
				</tr>
				<tr>
					<td><img src="./btn/r2.png" alt="R2"> R2</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td class="tb">0</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>FDFF</td>
				</tr>
				<tr>
					<td><img src="./btn/l2.png" alt="L2"> L2</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td class="tb">0</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>FEFF</td>
				</tr>
				<tr>
					<td><img src="./btn/dl.png" alt="←"> D-Pad Left</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td class="tb">0</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>FF7F</td>
				</tr>
				<tr>
					<td><img src="./btn/dd.png" alt="↓"> D-Pad Down</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td class="tb">0</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>FFBF</td>
				</tr>
				<tr>
					<td><img src="./btn/dr.png" alt="→"> D-Pad Right</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td class="tb">0</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>FFDF</td>
				</tr>
				<tr>
					<td><img src="./btn/du.png" alt="↑"> D-Pad Up</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td class="tb">0</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>FFEF</td>
				</tr>
				<tr>
					<td><img src="./btn/st.png" alt="Start"> Start</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td class="tb">0</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>FFF7</td>
				</tr>
				<tr>
					<td><img src="./btn/r3.png" alt="R3"> R3</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td class="tb">0</td>
					<td>1</td>
					<td>1</td>
					<td>FFFB</td>
				</tr>
				<tr>
					<td><img src="./btn/l3.png" alt="L3"> L3</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td class="tb">0</td>
					<td>1</td>
					<td>FFFD</td>
				</tr>
				<tr>
					<td><img src="./btn/se.png" alt="Select"> Select</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td>1</td>
					<td class="tb">0</td>
					<td>FFFE</td>
				</tr>
			</table>
			<p>When multiple buttons are pressed, the value gets set to [Button 1] AND [Button 2] AND ... [Button N]; for example when pressing R2 + Triangle + Circle the value gets set to <span class="ms">FDFF</span> AND <span class="ms">EFFF</span> AND <span class="ms">DFFF</span> == <span class="ms">CDFF (1100 1101 1111 1111)</span></p>
			<h4>Joker code calculator:</h4>
			<div id="jokercalc" style="display:flex;align-items:center;">
				<table style="float: left;">
					<tr>
						<td><img src="./btn/s.png" alt="□"></td>
						<td><img src="./btn/x.png" alt="X"></td>
						<td><img src="./btn/o.png" alt="O"></td>
						<td><img src="./btn/t.png" alt="△"></td>
						<td><img src="./btn/r1.png" alt="R1"></td>
						<td><img src="./btn/l1.png" alt="L1"></td>
						<td><img src="./btn/r2.png" alt="R2"></td>
						<td><img src="./btn/l2.png" alt="L2"></td>
						<td><img src="./btn/dl.png" alt="←"></td>
						<td><img src="./btn/dd.png" alt="↓"></td>
						<td><img src="./btn/dr.png" alt="→"></td>
						<td><img src="./btn/du.png" alt="↑"></td>
						<td><img src="./btn/st.png" alt="Start"></td>
						<td><img src="./btn/r3.png" alt="R3"></td>
						<td><img src="./btn/l3.png" alt="L3"></td>
						<td><img src="./btn/se.png" alt="Select"></td>
					</tr>
					<tr>
						<td><input type="checkbox" id="cc_s" value="32767"></td>
						<td><input type="checkbox" id="cc_x" value="49151"></td>
						<td><input type="checkbox" id="cc_o" value="57343"></td>
						<td><input type="checkbox" id="cc_t" value="61439"></td>
						<td><input type="checkbox" id="cc_r1" value="63487"></td>
						<td><input type="checkbox" id="cc_l1" value="64511"></td>
						<td><input type="checkbox" id="cc_r2" value="65023"></td>
						<td><input type="checkbox" id="cc_l2" value="65279"></td>
						<td><input type="checkbox" id="cc_dl" value="65407"></td>
						<td><input type="checkbox" id="cc_dd" value="65471"></td>
						<td><input type="checkbox" id="cc_dr" value="65503"></td>
						<td><input type="checkbox" id="cc_du" value="65519"></td>
						<td><input type="checkbox" id="cc_st" value="65527"></td>
						<td><input type="checkbox" id="cc_r3" value="65531"></td>
						<td><input type="checkbox" id="cc_l3" value="65533"></td>
						<td><input type="checkbox" id="cc_se" value="65534"></td>
					</tr>
				</table>
				<span style="vertical-align: middle; margin-left: 3px;">
					<span id="calc_res" class="ms">FFFF (NOT = 0000)</span><br>
					<span id="calc_warn" class="hidden">Up+Down or Left+Right is impossible on a controller!</span>
				</span>
			</div>
			<script>
				// My JavaScript/jQuery skills are even worse :)
				el = $('#jokercalc').find("[id^=cc_]");
				function calc() {
					res = 65535;
					for (i = 0; i < 16; i++) 
						if ($(el[i]).prop("checked"))
							res &= $(el[i]).prop("value");
							
					res += 65536; //Hacky way to force the inclusion of leading zeroes
					str = `${res.toString(16).toUpperCase().slice(-4)}  (NOT = ${(~res >>> 0).toString(16).toUpperCase().slice(-4)})`;
					$("#calc_res").html(str);
					
					if ( ($('#cc_dd').prop("checked") & $('#cc_du').prop("checked")) |
					($('#cc_dl').prop("checked") & $('#cc_dr').prop("checked")) )
						$("#calc_warn").removeClass("hidden");
					else $("#calc_warn").addClass("hidden");
				}
				$(el).on("click", calc);
			</script>
		</div>
	</body>
</html>